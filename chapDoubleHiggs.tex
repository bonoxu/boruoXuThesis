\chapter{Double Higgs Bosons Analysis}
\label{chap:DoubleHiggs}

\section{Motivation}

Ha there is a higgs.

We found higgs. Higgs is cool. It explains mass.

Why double higgs. Double higgs coulpling is unique to linear collider. It can revel much about the BSM models.

Generator level study has performed. ILC has done this this and that. gHHH in CLIC before

Here we do things differently. First subchannels, then extract both couplings simultaneously.

\section{Theory}

general higgs field

Lagrangian

current constraunt

single higgs coupling measurement done in higgs

Double higgs measurement

The main mechanism for double Higgs production %in \epem collisions
%at high energy CLIC ($\sqrt{s}>$\SI{1}{\TeV}) is via $WW$-fusion ($\epem\to HH\nu\overline{\nu}$). The main Feynman diagrams contributing to the process are illustrated in Figure . %The cross section for the process increases with the centre-of-mass energy: from \SI{0.15}{\fb} at $\sqrt{s}=$\SI{1.4}{\TeV} to \SI{0.59}{\fb} at $\sqrt{s}=$\SI{3}{\TeV}, assuming a %Higgs mass of \SI{126}{GeV}.

\section{Analysis Straggly Overview}

Proof-of-principle study was perform at \CLIC for \rootS{1.4} and 3\,TeV. Simulated samples, including those containing double higgs production were used. Signal events, events with double higgs production, were selected via a set of carefully designed and complicated methods. \gHHH and \gWWHH are extracted simultaneously with template fitting with modified couplings samples.
\section{Monte Carlo Sample Generation}


% TODO
% Understand bremsstrahlung and EPA
Single channel is defined as \eeToHH. It is divided into sub-channel \eeToHHbbWW and \eeToHHbbbb to allow closer examination and an improvement of signal selection when combined. In particular, I studied \eeToHHbbWW sub-channel.

Selected background samples, including processes initiated by photons, are considered in the analysis and listed in Table \ref{tab:doubleHiggsMCSamples}. These background were expected share similar topologies with the signal process. When describing a multi-quark final state, it is referring to  all final states of the same number of quarks, including final states with possible additional neutrinos and or leptons. A multi-quark final state does not include higgs production, unless explicitly stated.

The usual two-quark and four-quark final states were considered.
Since the significant presence of beamstrahlung, where photon produced due to the high electric field generated by the colliding beams, processes initiated by photons are also included.

Processes invloving real photons from beamstrahlung (BS) and ``quasi-real'' photons are generated separately. For the ``quasi-real'' photon initiated processes, the Equivalent Photon Appproximation (EPA) has been used.

Photon-electron/photon-photon interactions with four-quark final states were considered. Photon-electron interaction with two-quark final state, one Higgs, and one neutrino is considered. Photon-electron interaction with two-quark final state, one Higgs, and one lepton is not considered due to its negligible cross section.

%I have just checked the ea->qqHl and ea->qqHv processes at 3 TeV. While ea->qqHl has a very small cross section (0.07 fb with photon from EPA, 0.6 fb with photon from BS), the ea->qqHv final state might not be negligible (4 fb with photon from EPA, 59 fb with photon from BS). The events will be very forward (more than the signal I assume). But of course I'm producing MC samples so that we can check.

Single higgs productions are not considered because topologies are very different to the single process.
Six-quark final states were not considered due to computational limitation.

For processes involving Higgs production explicitly, simulated Higgs mass is 126\,GeV.
As multi-quark final state background samples could, in principle, contain double higgs production, they are generated with a Higgs mass of 14\,TeV. This will produce negligible double higgs production cross section.





% discussion of B
%Since the significant presence of beamstrahlung\footnote{photon emission due to the high electric field produced by the colliding beams}, processes initiated by photons are also included.
%Processes initiated by real photons from beamstrahlung (BS) and ``quasi-real'' photons are generated separately. For the ``quasi-real'' photon initiated processes, the Equivalent Photon Appproximation (EPA) has been used. In order to avoid double counting with the signal processes, most of the background samples have been generated assuming a Higgs mass of \SI{14}{\TeV}, where not possible Higgs events are removed during the analysis.

All samples are generated with WHIZARD 1.95 \cite{}, taking into account the expected \CLIC luminosity spectrum.
%\footnote{Photon radiation due to beamstrahlung causes a reduction of the effective energy available in the collision.}.
PYTHIA 6.4 \cite{} tuned on LEP data \cite{} is used to describe fragmentation, hadronisation processes, and Higgs decays. TAUOLA \cite{} is used for $\tau$ lepton decays.

Simulation

For most background processes, events are simulated when invariant mass of quarks are above 50\,GeV. For electron-photon interaction with four quarks and a neutrino final state, events are simulated when invariant mass of quarks are above 120\,GeV. These limits are necessary to generate a large amount of background samples in a feasible time, without losing much signal samples.

Finally, the main beam induced background \ggHad is simulated and overlayed \cite{} to all samples according to the integration time of each subdetector.  \begin{table}\centering

%\small{
\begin{tabular}{lrr}
\hline\hline
Channel  &  $\sigma(\rootS{3})$ / fb  & $\sigma(\rootS{1.4})$ / fb   \\
\hline
\eeToHH &0.588& 0.149 \\
\hline
\eeTo{\qlight \qlight \PHiggs \Pnu \APnu} & 1.78 & 0.86  \\
\eeTo{\Pcharm \APcharm \PHiggs \Pnu \APnu} & 1.12 & 0.36 \\
\eeTo{\Pbottom \APbottom \PHiggs \Pnu \APnu} & 1.91 & 0.31 \\

\eeTo{ \Pquark \Pquark \Pquark \Pquark}  & 546.5 &   1245.1\\
\eeTo{ \Pquark \Pquark \Pquark \Pquark \Plepton \Plepton}&169.3& 62.1 \\
\eeTo{ \Pquark \Pquark \Pquark \Pquark \Plepton \Pnu}&106.6& 110.4 \\
\eeTo{ \Pquark \Pquark \Pquark \Pquark \Pnu \APnu} &71.5& 23.2 \\

\eeTo{ \Pquark \Pquark}&2948.9&  4009.5 \\
\eeTo{ \Pquark \Pquark \Plepton \Pnu}&5561.1&  4309.7 \\
\eeTo{ \Pquark \Pquark \Pl \Pl} &3319.6&  2725.8 \\
\eeTo{ \Pquark \Pquark \Pnu \Pnu}&1317.5 & 787.7 \\
\hline
\egamma{\Pem}{\Pphoton}{BS}{\Pem \Pquark \Pquark \Pquark \Pquark} & 1268.7 & 1160.7 \\
\egamma{\Pep}{\Pphoton}{BS}{\Pep \Pquark \Pquark \Pquark \Pquark} & 1267.6 & 1156.3 \\
\egamma{\Pem}{\Pphoton}{EPA}{\Pem \Pquark \Pquark \Pquark \Pquark}& 287.9 & 287.1 \\
\egamma{\Pep}{\Pphoton}{EPA}{\Pep \Pquark \Pquark \Pquark \Pquark} & 287.8 & 286.9 \\
\egamma{\Pem}{\Pphoton}{BS}{\Pnu \Pquark \Pquark \Pquark \Pquark} & 262.5& 136.9 \\
\egamma{\Pep}{\Pphoton}{BS}{\APnu \Pquark \Pquark \Pquark \Pquark} & 262.3& 136.4 \\
\egamma{\Pem}{\Pphoton}{EPA}{\Pnu \Pquark \Pquark \Pquark \Pquark} & 54.2& 32.6 \\
\egamma{\Pep}{\Pphoton}{EPA}{\APnu \Pquark \Pquark \Pquark \Pquark} & 54.2& 32.6 \\

\egamma{\Pem}{\Pphoton}{BS}{\Pquark \Pquark \PHiggs \Pnu \Pnu} & 58.6 & 15.8  \\
\egamma{\Pep}{\Pphoton}{BS}{\Pquark \Pquark \PHiggs \Pnu \Pnu} & 58.5 & 15.7  \\
\egamma{\Pem}{\Pphoton}{EPA}{\Pquark \Pquark \PHiggs \Pnu \Pnu} & 11.7 & 3.39  \\
\egamma{\Pep}{\Pphoton}{EPA}{\Pquark \Pquark \PHiggs \Pnu \Pnu} & 11.7 & 3.39  \\
\hline
\gammagamma{\Pphoton}{BS}{\Pphoton}{BS}{ \Pquark \Pquark \Pquark \Pquark} &13050.3& 21406.2 \\
\gammagamma{\Pphoton}{BS}{\Pphoton}{EPA}{ \Pquark \Pquark \Pquark \Pquark} &2420.6& 4018.7 \\
\gammagamma{\Pphoton}{EPA}{\Pphoton}{BS}{ \Pquark \Pquark \Pquark \Pquark}&2423.1& 4034.8 \\
\gammagamma{\Pphoton}{EPA}{\Pphoton}{EPA}{ \Pquark \Pquark \Pquark \Pquark}&402.7& 753.0 \\
\hline \hline
\end{tabular}
%}
\caption{List of signal and background samples with the corresponding cross sections at \rootS{3} and \rootS{1.4}. \Pquark can \Pup, \Pdown, \Pstrange, \Pbottom or \Ptop. Unless specified, \Pquark, \Plepton and \Pnu represent particles and its corresponding anti-particles. \Pphoton(BS) represents a real photon from beamstrahlung (BS). \Pphoton(EPA) represents a ``quasi-real'' photon, simulated with the Equivalent Photon Approximation. For processes involving Higgs production explicitly, simulated Higgs mass is 126\,GeV. Otherwise, Higgs mass is set to 14\,TeV.
}
\label{tab:samples_xsec}
\end{table}

\section{Physics object and event reconstruction}

Simulation is performed by MOKKA, interfacing GEANT 4.
The reconstruction is done via Marlin in iLCSoft. Separate software package (processor) exists for identification of electrons, muons, taus, and jet reconstruction. New processors have been developed and existing processors have been optimised for a compromise of signal selection and background rejection.

For my signal channel, \eeToHHbbWW, there is no lepton in the final state. Hence a effective lepton identifier would improve the signal identification. Processors are wither developed or optimised with samples at \rootS{1.4}, and checked against samples at \rootS{3}. Because the expected signal significance would be low, the processors are optimised to reject more background at the cost of losing a bit more signals, to increase the signal significance. It was found that the same set of parameters work well under \rootS{1.4} and 3\,TeV.

\subsection{Electron and Muon identification}
\label{sec:doubleHiggsLeptonID}


\subsubsection{IsolatedLeptonFinderProcessor}

In Marlin package, IsolatedLeptonFinderProcessor has been used. The optimal parameters ware chosen in collaboration and tested. The particle is identified as an isolated light lepton if it passes a chain of cuts.

A charge track is considered if it has more than 15\,GeV energy. An electron is identified if the energy in the ECal is over 90\% of the total calorimetric energy. A muon is identified if the energy in the ECal is between 5\% and 25\% of the total calorimetric energy. Furthermore, only primary track is selected, which requires the Euclidean distance in the x-y plane, the in z direction, and in the x-y-z three dimensional space of the track starting point to the impact point to be less than 0.02\,mm, 0.03\mm, and  0.04\,mm, respectively. The isolation criteria states that
\begin{equation}
E_{cone}^2 \leqslant 5.7 \times E_{l} - 50
\end{equation}
where, $E_{cone}$ is the total energy of PFOs within an opening angle of $\cos^{-1}(0.995)$ of the light lepton, and $E_{l}$ is the energy of the light lepton.

\subsubsection{BonoLeptonFinderProcessor}

The IsolatedLeptonFinderProcessor is rather conservative. I developed a new more aggressive light lepton selection processor, BonoLeptonFinderProcessor, that utilises calorimetric information provided by PandoraPFA. 

The processor uses two chains of cuts. 

First chain uses the particle ID information from PandoraPFA. A electron is identified if it is a ``PandoraPFA'' electron and the energy in the ECal is over 95\% of the total calorimetric energy. A muon is identified if it is a ``PandoraPFA'' muon.  Primary track selection states the Euclidean distance in the x-y-z three dimensional space of the track starting point to the impact point to be less than 0.015\,mm, and the PFO energy is more than 10\,GeV. The light lepton either satisfy the high \pT requirement of at least 40\,GeV, or the isolation criteria,
\begin{equation}
E_{l} \geqslant 23 \times \sqrt{E_{cone}} + 5
\end{equation}
where $E_{cone}$ and $E_{l}$ have the same definition as in the IsolatedLeptonFinderProcessor.

Second chain of cuts is similar to the IsolatedLeptonFinderProcessor. An electron is identified if the energy in the ECal is over 95\% of the total calorimetric energy. A muon is identified if the energy in the ECal is between 5\% and 20\% of the total calorimetric energy. Primary track selection states the Euclidean distance in the x-y-z three dimensional space of the track starting point to the impact point to be less than 0.5\,mm, and the PFO energy is more than 10\,GeV. The light lepton either satisfy the high \pT requirement of at least 40\,GeV, or the isolation criteria,
\begin{equation}
E_{l} \geqslant 28 \times \sqrt{E_{cone}} + 30
\end{equation}
where, $E_{cone}$ is the total energy of PFOs within an opening angle of $\cos^{-1}(0.99)$ of the light lepton, and $E_{l}$ is the energy of the light lepton.

\subsubsection{Comparison: IsolatedLeptonFinderProcessor v.s. BonoLeptonFinderProcessor}

Two processors share similar criterion for light lepton identification. The main difference is that the BonoLeptonFinderProcessor allows high \pT light lepton to be identified in a potential non-isolated environment, which leads to the more aggressiveness of the BonoLeptonFinderProcessor. The performance of two processors on the signal and selected background samples is shown in \Table{tab:doubleHiggsIsoLepPerformance}


\subsubsection{TauFinderProcessor}

% TODO check tau stuff
With a decay length of 87$\mu{m}$, tau leptons decay before reaching the detector and can only be identified through the reconstruction of their decay products. The leptonic decay of tau can be identified using the two isolated lepton finder processor. Therefore tau identification will focus on the hadronic decay.

TauFinderProcessor, an existing processor Marlin package, has been tuned in collaboration and tested. The a collection of tau decay productions are identified they pass a chain of cuts.

Particles are not considered if \pT is less than 1\,GeV or \absCosTheta is more than 1.1\,rad, as they are more likely from beam induced background. A seed is considered if a charged particle has \pT more than 10\,GeV. A search cone of opening angle 0.03\,rad is then formed. The search cone is rejected if it has more than 3 charged particles, more than 10 particles or its invariant mass more than 2\,GeV. An isolation cone is formed with opening angle between 0.03 and 0.33\,rad of the seed. The seed is rejected if there are more than 3\,GeV in the isolation cone.

\subsubsection{BonoTauFinderProcessor}

The TauFinderProcessor's performance is decent, but there is room for improvement. I developed a new more aggressive tau lepton selection processor, BonoTauFinderProcessor, that utilises calorimetric information provided by PandoraPFA.

Similar to the previous processor, PFOs with \pT less than 1\,GeV are rejected. A tau seed is defined as a charged particle with \pT at least 5\,GeV. The search cone has an opening angle of $\cos^{-1}(0.999)$. Particles are iteratively added to the search cone according to the size of the opening angle to the seed. A temporary search cone is then considered if it has one or three charged particles, and the invariant mass is less than 3\,GeV. The search cone needs to satisfy one of isolation criterion.
\begin{enumerate}
\item No particle in the large isolation cone, and \pT of search cone at least 10\,GeV,
\item One charged particle in the search cone, one particle in the large isolation cone, and \rZero larger than 0.01\,mm,
\item Three charged particle in the search cone, one particle in the large isolation cone,\pT of search cone at least 10\,GeV, and search cone opening angle less than $\cos^{-1}(0.9995)$,
\item One charged particle in the search cone, no particle in the small isolation cone, \rZero larger than 0.01\,mm, and \pT of search cone at least 10\,GeV,
\item Three charged particle in the search cone, no particle in the small isolation cone,\pT of search cone at least 10\,GeV, and search cone opening angle less than $\cos^{-1}(0.9995)$,
\end{enumerate}
where large and small isolation cone are defined as opening angle of $\cos^{-1}(0.95)$, and $\cos^{-1}(0.99)$ respectively.
If there are multiple temporary search cone of a same seed passing the isolation criteria, the cone with smallest opening angle is chosen for output.

\subsubsection{Comparison: TauFinderProcessor v.s. BonoTauFinderProcessor}

Two processors share similar size of search cone and isolation cone. The BonoTauFinderProcessor has looser cut on minimum \pT and invariant, but stricter isolation criterion. This leads to a more aggressive tau finder. The performance of two processors on the signal and selected background samples is shown in \Table{tab:doubleHiggsIsoLepPerformance}

\subsubsection{Very Forward Electron Identification}


\begin{table}
\begin{tabular}{lrr}
\hline
\hline
Processor / Efficiency (3\,TeV)  &  Signal  & \HepProcess{\Pquark\Pquark\Pquark\Pquark\Plepton\Pnu} \\
\hline
IsolatedLeptonFinderProcessor & 99.5\% & 66.8\%  \\
BonoLeptonFinderProcessor & 99.0\% & 52.5\%  \\
TauFinderProcessor & 97.7\% & 79.5\%  \\
BonoTauFinderProcessor & 86.3\% & 60.3\%  \\
ForwardFinderProcessor & 95.9\% & 80.7\%  \\
Combined & 81.0\% & 23.3\%  \\
\hline
Selection / Efficiency (1.4\,TeV)  &  Signal & \HepProcess{\Pquark\Pquark\Pquark\Pquark\Plepton\Pnu} \\
\hline
IsolatedLeptonFinderProcessor & 99.3\% & 50.3\%  \\
BonoLeptonFinderProcessor & 99.1\% & 39.9\%  \\
TauFinderProcessor & 97.5\% & 52.3\%  \\
BonoTauFinderProcessor & 89.7\% & 38.5\%  \\
ForwardFinderProcessor & 98.9\% & 95.1\%  \\
Combined & 86.6\% & 16.8\%  \\

\hline

\end{tabular}
\caption{isolated lepton finder processors performance on the signal and selected background samples.}
\label{tab:doubleHiggsIsoLepPerformance}
\end{table}

\subsubsection{Other Processors}

Other isolated lepton selection processors available in Marlin package, including IsolatedLeptonTagging and TauJetClustering, have been tested. The results, after some tuning of parameters, were unsatisfactory. They either performed poorly comparing to the processors above, or became redundant after the processors above. Therefore, these processors were not used in this analysis.

For the identification of electrons and muons the IsolatedLeptonFinderProcessor \cite{} has been used. The processor uses a combination of track energy, calorimeter energy, impact parameter, and isolation information to distinguish between light leptons and other objects.
In order to improve the identification efficiency, the method has been integrated with the particle flow information from Pandora \cite{}. Particle ID from Pandora uses shower shape information which is complementray to the IsolatedLeptonFinderProcessor.
%A detailed list of variables and selection cuts is reported in Table . Since lepton identification enters in the analysis categorisation, the same criterion have been used for the two sub-channels. Moreover, different criterion have been optimised for the two centre-of-mass energy \SI{3}{\TeV} and \SI{1.4}{\TeV}.

%Very forward electrons with polar angle outside the tracker acceptance ($\theta\lesssim6^\circ$) cannot be identified using the IsolatedLeptonFinderProcessor. Nevertheless, the forward calorimeters, the BeamCal and the LumiCal, are dedicated to the tagging of such forward electromagnetic objects. In the production samples used for this analysis, the simulated information for the reconstruction in this very forward region has not been recorded due to technical issues. Therefore, MC information is used to identified both electrons and photons (since there is no tracking information available, it is not possible to distinguish between them with the CLIC detectors) and the efficiencies measured in test beams are applied in the analysis. The detection efficiency for the LumiCal is taken from xxx \cite{} and for the BeamCal, it is simulated with Andre processor \cite{}. %as a function of angles and momentum
This results in a significant rejection of background events with forward electrons and positrons, at the price of a moderate loss of signal events, O(\%).   \\

%\subsection{Tau identification}
%\label{sec:tau}

%With a decay length of \SI{87}{\micro\m}, tau leptons decay before reaching the detector and can only be identified through the reconstruction of their decay products.
For the identification of tau lepton decays, the TauFinder \cite{} has been used. The processor aims to identify high energetic, low multiplicity jets, including criteria on impact parameter and cone isolation. This method has been improved by searching for 1-prong and 3-prong decays specifically, which account for X\% of the tau lepton decays.
